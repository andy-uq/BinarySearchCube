using System;
using System.Linq;
using Shouldly;
using Xunit;

namespace CubeTests
{
	public class AddItems
    {
        [Theory]
		[InlineData(-1)]
		[InlineData(0)]
		[InlineData(1)]
		[InlineData(int.MaxValue)]
		[InlineData(int.MinValue)]
        public void AddKey(int key)
        {
	        AddAndVerifyKeys(new []  { key });
        }

        [Theory]
		[InlineData(-1)]
		[InlineData(1)]
		[InlineData(int.MaxValue)]
		[InlineData(int.MinValue)]
        public void AddSecondKey(int key)
        {
	        AddAndVerifyKeys(new []  { 0, key });
        }

        [Fact]
        public void AddForward()
        {
	        var keys = Enumerable.Range(1, 1000).ToArray();
	        AddAndVerifyKeys(keys);
        }

        [Fact]
        public void AddZipped()
        {
	        var keys = Enumerable.Range(1, 1000).ToArray();
	        for (var i = 1; i < 500; i+=2)
	        {
		        var swap = keys[i];
		        keys[i] = keys[^i];
		        keys[^i] = swap;
	        }

	        AddAndVerifyKeys(keys);
        }

        [Fact]
        public void SplitY()
        {
	        var keys = Enumerable.Range(1, 31).ToArray();
	        var cube = AddAndVerifyKeys(keys);

			cube.SetKey(32, "32");
			cube.GetKey(32).ShouldBe("32");
        }

        [Fact]
        public void AddBackward()
        {
	        var keys = Enumerable.Range(1, 1000).Reverse().ToArray();
	        AddAndVerifyKeys(keys);
        }

        [Fact]
        public void AddRandom()
        {
	        var keys = new[]
	        {
		        783253225, 2077088753, 1125992712, 1393795991, 1517262247, 1840235326, 604573506, 2056967829, 752689600,
		        548905644, 410466157, 1245153383, 61545790, 288615942, 1699483670, 2112671259, 566646501, 1551893248,
		        2031654798, 1634584815, 2121509913, 339786488, 609352934, 1594827683, 144545905, 150551233, 837325275,
		        1480862259, 608666425, 1051844113, 639300947, 1550183137, 1379755114, 294246126, 127827348, 1651601459,
		        1669985221, 639393349, 1296098984, 1903521520, 284475976, 418831506, 1006009063, 1084554719, 1188557659,
		        2097004569, 780603141, 2097557661, 238471649, 1177522741, 1233526530, 1528574210, 1794375571, 402290977,
		        639047282, 443466737, 1467735819, 1678648676, 1249250086, 1366711014, 1002910051, 1271194894,
		        1448301404, 1848329134, 2057088344, 1007766667, 2012881916, 1914783311, 160788594, 47882211, 442686038,
		        2074736799, 255794264, 128133278, 1350108839, 1702678407, 1481261072, 1672281862, 406270024, 195024983,
		        1517431739, 887251261, 1242390610, 1578627331, 1965801230, 1258210384, 1903291213, 977464137,
		        1802682491, 1831844258, 183865640, 2138820192, 1537626910, 2076871617, 900611469, 1160764729,
		        1118013749, 1305163576, 1174950022, 180790992, 84122653, 1013303477, 1936769067, 190589438, 734836703,
		        1306273378, 1272779946, 1666242293, 1199665785, 1083852522, 1109689312, 1942937604, 1272378652,
		        1054225103, 1996762922, 115658790, 28804284, 2017157720, 2030011551, 798877960, 1251959101, 1035417779,
		        112100820, 476427983, 2011500218, 451349493, 537109889, 326406294, 1375005456, 189344110, 584664658,
		        176097496, 497331840, 225479032, 110902330, 504128262, 1097965841, 1051801172, 843790628, 659527852,
		        2132914085, 237048920, 1925281999, 718829969, 722154946, 388411683, 866441540, 483401807, 80108695,
		        784952679, 1131960445, 1248339676, 1422635672, 376072062, 1076315538, 1196188521, 901202657, 1460341084,
		        326572867, 283487210, 769163489, 946373652, 291236837, 1010321675, 499187864, 933591816, 1445605764,
		        1046899620, 943322773, 1492634660, 1165176596, 1124486759, 1173367092, 1370483699, 813447522,
		        1014910181, 1257619427, 1540754498, 1901756684, 1623088535, 1732391600, 53708082, 246297599, 590052777,
		        1204867312, 1483808629, 900945471, 121259778, 1296647141, 1062197456, 1750409252, 1785108404, 725228305,
		        560303418, 2037848010, 1186540433, 2093295730, 914960324, 219642105, 1936046777, 1090289566, 1967025567,
		        1687562681, 734957682, 1767259730, 7473686, 74972584, 52151973, 1710108187, 61405357, 2086052741,
		        1507931806, 1706068047, 850967979, 698579257, 715455407, 700076053, 1848667707, 1952938010, 1162862882,
		        32646345, 1324345986, 1897736126, 2028608964, 1889709055, 1527551839, 399258454, 613063674, 1480119336,
		        1774390736, 1069098098, 342659103, 1321112393, 2113193554, 532798969, 1912849680, 513629048, 1658823564,
		        970276694, 1197393626, 1408836045, 848793498, 558635238, 1235241784, 1123628362, 242477446, 79040357,
		        2021743973, 2009207808, 1322392603, 486464380, 244628023, 1109505961, 1204262870, 1903400432,
		        1913427227, 69289441, 1806437364, 992732274, 239707891, 1755698879, 1609392557, 719516284, 2083201098,
		        1139790906, 1743393638, 186819413, 1740358140, 318169010, 933213224, 201826359, 1188736136, 878391013,
		        755544384, 1901510484, 1331336494, 765710748, 662494342, 904980602, 1647231609, 1448511482, 524998128,
		        751339513, 157726733, 1287926356, 824470075, 1380636789, 116849523, 209793122, 766855389, 1843560239,
		        854675331, 666091290, 730568803, 1589178394, 1946927135, 129277214, 622917787, 95450878, 1527718371,
		        55658033, 486165864, 1703574963, 1075994584, 1120566244, 1445211891, 1513720657, 353961577, 1450236033,
		        572063938, 1147716479, 1554278746, 901456762, 1492984312, 938680056, 1230700751, 858053044, 561789551,
		        795274742, 315320831, 362756849, 69969890, 1530565018, 1698797268, 1237136632, 1494634675, 522644846,
		        147822210, 1313849637, 2102066996, 1202059280, 142792961, 567043464, 1524745878, 1591573576, 962345618,
		        968906812, 1822828576, 1184644136, 1990198112, 1458233065, 1026675212, 814097137, 1785212831,
		        1766622557, 289281493, 2100702216, 1320590625, 1939372394, 358477643, 1088874091, 1714971310,
		        1975126692, 1927613694, 1164961522, 2133171790, 1103084493, 4777695, 1986341599, 1773415216, 922567045,
		        1365898447, 1187595587, 1495652684, 1517488305, 1004923518, 987235282, 1524194531, 2048894383,
		        2123818085, 261793939, 1182708115, 1524629062, 952560277, 1004571413, 1483565284, 1403356400,
		        1892835834, 2079658358, 947855139, 1541416106, 1349537868, 355933463, 955371994, 1013192905, 1634571617,
		        315149916, 786913417, 359784356, 1605885433, 2006744772, 964129117, 1983970624, 1558712567, 1067631067,
		        92334618, 1986563272, 1465928100, 267724526, 761699039, 1449529858, 576507685, 1419179889, 1963037956,
		        96683704, 2053649623, 190342248, 1022566415, 923042281, 1828879885, 729815390, 1357732306, 72602984,
		        1038486460, 231999110, 1720512824, 1009964984, 232223593, 482459779, 2030400335, 689773602, 200321865,
		        1164410175, 443008950, 117073313, 1445148469, 1346221138, 2113400142, 2032412857, 912236795, 1644485659,
		        2084911947, 1625111308, 1317959319, 1645808928, 964908421, 2077841626, 540379154, 858688290, 1107026929,
		        1444229369, 1440067148, 2011354783, 678388118, 876070043, 649012466, 891526133, 945484164, 1326713457,
		        1494601890, 1229853281, 1754339679, 983468321, 384807838, 71925437, 1249207993, 1559581157, 976170939,
		        1845964643, 799018882, 707428485, 224425753, 1137637205, 10805486, 184394226, 792387090, 1880104645,
		        902127312, 1540161179, 1414574336, 1790154845, 469585830, 1521018950, 1522916497, 586170966, 1397190101,
		        336450729, 486022057, 1714422554, 1615544494, 553622336, 400736974, 786686685, 537810967, 1829867161,
		        2037629627, 1101443626, 1240303470, 1246033882, 396600935, 1552810911, 1101670687, 841898158, 59669408,
		        399598444, 1219803616, 302429943, 2000549297, 493993892, 83682953, 916391468, 2136882468, 1552806632,
		        2059622768, 1851930692, 760267451, 233320729, 1608035471, 1946120519, 822218983, 912757264, 1073559100,
		        1409232032, 230420149, 245396546, 306691511, 1585222715, 599826238, 328421972, 294248246, 1838427111,
		        639801175, 1803577077, 1143560244, 2009247072, 688484158, 1775171319, 1461349542, 1123318053,
		        1513850997, 1094760158, 483385079, 2139511812, 1630739601, 699153026, 564223515, 995413989, 874547564,
		        833363922, 1069599710, 1804308898, 1640891802, 1441666598, 423814899, 1631327318, 479251811, 1839922302,
		        611478009, 1961756509, 92906933, 1782064548, 1850087352, 1672127325, 199745646, 392739489, 276590293,
		        333305391, 409246388, 50375696, 1163446534, 1132579779, 919454834, 484717418, 432269522, 1874942472,
		        429372185, 1081530935, 1925976078, 1678750770, 1828656678, 1458761169, 710675151, 1913945963,
		        1406305909, 637422995, 197535309, 1345618224, 1379762178, 1659716573, 1529995261, 996045503, 1163693310,
		        1647076680, 1030411120, 1879270096, 1392156453, 958741401, 1939766166, 1238000112, 422562733, 230918124,
		        586167601, 824171868, 1817401035, 2084503578, 884854064, 1156174384, 1009397076, 696356074, 1201955133,
		        1545204523, 2061429871, 1080210886, 133099831, 781629411, 1071389397, 2083625036, 265821416, 1709806298,
		        195204180, 1078455716, 1101026860, 897013462, 667864082, 167401031, 2116370116, 1419861801, 1601789945,
		        700483073, 482786019, 1618114431, 1289248416, 687975966, 1256188037, 1597738554, 872593568, 2033986930,
		        96544928, 1469285978, 1900052578, 1188844572, 336221148, 683406104, 457761440, 2132274385, 1082099279,
		        83482424, 1513976849, 248781709, 807880699, 1456015064, 692919985, 229959868, 1042795932, 1491590664,
		        1277374911, 1836637786, 156307786, 1650000004, 2115617109, 1612475910, 1701868086, 308914003, 213570055,
		        1731324349, 255956107, 1373453905, 1971506496, 682844924, 2056519490, 1184886114, 1987080108, 944019085,
		        1957237367, 1153843255, 742234568, 417620756, 439252022, 683073344, 1232785399, 2032887692, 2053368599,
		        1353008236, 2040086021, 1174254602, 925194446, 1059288548, 1792663681, 1912081020, 320363643,
		        1183439429, 1877679144, 594028571, 1501152516, 287576668, 1634460133, 27307145, 469836049, 873920738,
		        1876318278, 1856129021, 259459575, 831131925, 339745866, 1770478232, 1616418603, 1896384547, 420206148,
		        2036436324, 749356096, 859754155, 1397385764, 1620718089, 417214605, 82729417, 1706590958, 348859850,
		        416311629, 1186799100, 806129903, 1344151206, 1728273871, 59425476, 362481281, 873080061, 1454690617,
		        1393051537, 1590350216, 1669660699, 1666866769, 714927423, 2095268354, 1712814931, 954238713,
		        1524140025, 1773428117, 1222236674, 1013262370, 269607789, 1705319646, 1176293546, 639082400,
		        1903711004, 1162724924, 1608093135, 1933537312, 256961055, 176813966, 1418423099, 728469357, 1285600283,
		        1758479163, 1430520596, 67790835, 532167072, 127855150, 200034099, 468650644, 1614149452, 315787615,
		        223367066, 306034331, 898029096, 369569555, 34428673, 911969448, 1832054480, 666479376, 1040558227,
		        456784947, 484354284, 1483081127, 146703840, 1628963101, 1777320004, 705068806, 1972046514, 1044184199,
		        901871793, 1087026396, 1197729562, 1216237571, 171927117, 941191342, 381266486, 1103931907, 664747758,
		        1645024096, 422071641, 1396284875, 1573394018, 753586030, 1546596565, 2101303821, 1481952580, 870259215,
		        1888536951, 1534141449, 1128296251, 696123687, 101482832, 1737965326, 1283739386, 961638152, 244115073,
		        1950002803, 1611775323, 1949041142, 437954478, 1974581913, 303292283, 1303333547, 1714262498, 527123056,
		        1265541700, 1154613142, 134107214, 2104321401, 2135786716, 1077980413, 247221690, 187030384, 244407735,
		        1791756999, 1030874576, 1878251901, 2083968209, 192883666, 147010521, 907060789, 964015502, 437905065,
		        2063371595, 205748106, 985543564, 1607247883, 2079981832, 1357772612, 697076269, 578747330, 1639640231,
		        863190263, 1207069618, 594973375, 1092992592, 270060471, 1186807179, 1019473509, 835762121, 327339438,
		        736152001, 1931699197, 1545838380, 50315838, 448901997, 2061936095, 1493557591, 1639466034, 2078247223,
		        513346819, 2013518241, 1418891657, 1802030621, 1678377336, 1010566411, 2012870865, 1387445599,
		        1508514392, 1689063139, 1805777464, 1222114957, 923818249, 1407245132, 1557039386, 1585823829,
		        1531515074, 1127444413, 1796918007, 698764407, 760814105, 691444722, 1064494700, 1504605192, 1967154730,
		        170908788, 1179799952, 1039550332, 2013055757, 1904329756, 1071091116, 113690292, 440515798, 1427009036,
		        183729450, 712712736, 220748574, 1208643289, 1676175929, 1731890611, 1227605374, 1030098519, 1825776434,
		        1477894017, 1177468304, 1252708128, 1959817399, 524454065, 2136282641, 611975656, 1064870570, 934491682,
		        1844123231, 940701627, 1317433118, 1969385744, 949023541, 2061770112, 1982359538, 1507468548,
		        1978250106, 973320533, 1521873489, 1751668283, 617972023, 1692087172, 781599159, 1644292860, 1223515682,
		        844326650, 1365075255, 322871785, 1598752131, 65027396, 1618642680, 1878199233, 1013151935, 1734084330,
		        327136888, 714446602, 358575036, 655345887, 1050751338, 1401080101, 839459186, 136599434, 417050708,
		        1647297818, 109575918, 361827353, 1911172842, 306462109, 1373767398, 168707381, 1901124152, 254284841,
		        1655708677, 74108151, 859921994, 1632864779, 471108969, 315524539, 1448422030, 1291955991, 1394384048,
		        741998785, 1483223198, 1779095835, 1469542594, 1586717532, 956233809, 1362422858, 1734633224,
		        1267912936, 1148893512, 1322904219, 2070052842, 120793388, 912209097, 481372589, 1275036464, 1281784988,
		        1534716942, 861688329, 1080637455, 1058613146, 1096588034, 1430044750, 311386891, 1364357839, 222490556,
		        939043784, 874162336, 841755756, 243337633, 43050497, 1354407504, 1906278994, 6696053, 97460401,
		        800859883, 785438520, 177755224, 670342033, 1553077191, 548749984, 719312532, 105854462, 1167297516,
		        578219933, 331715646
	        };

	        AddAndVerifyKeys(keys);
        }

        private static Cube.Cube AddAndVerifyKeys(int[] keys)
        {
	        var cube = new Cube.Cube();
	        for (var i = 0; i < keys.Length; i++)
	        {
		        cube.SetKey(keys[i], Convert.ToString(keys[i]));
		        var values = keys.Take(i).Select(j => cube.GetKey(j));
		        values.ShouldBe(keys.Take(i).Select(j => Convert.ToString(j)), $"Failed to insert item {i + 1} (key: {keys[i]})");
	        }

	        cube.Validate();
	        return cube;
        }
    }
}
